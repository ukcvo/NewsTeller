<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

	<import resource="usabilityFeatures.xml" />

	<bean id="ksAdapter"
		class="edu.kit.anthropomatik.isl.newsTeller.knowledgeStore.KnowledgeStoreAdapter">
		<constructor-arg name="getMentionFromEventFileName"
			value="resources/SPARQL/general/getMentionFromEvent.qry" />
		<property name="serverURL" value="http://knowledgestore2.fbk.eu/nwr/wikinews" />
		<property name="timeoutMsec" value="10000" />
	</bean>

	<bean id="finder0"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.finding.EventFinder">
		<constructor-arg name="userQueryConfigFileName"	value="config/SPARQL/finding_userQuery_Scope0.txt" />
		<constructor-arg name="userInterestConfigFileName" value="config/SPARQL/finding_userInterest_Scope0.txt" />
		<constructor-arg name="previousEventConfigFileName"	value="config/SPARQL/finding_previousEvent_Scope0.txt" />
		<property name="ksAdapter" ref="ksAdapter" />
		<property name="nThreads" value="1"/>
	</bean>

	<bean id="finder1"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.finding.EventFinder">
		<constructor-arg name="userQueryConfigFileName"	value="config/SPARQL/finding_userQuery_Scope1.txt" />
		<constructor-arg name="userInterestConfigFileName" value="config/SPARQL/finding_userInterest_Scope1.txt" />
		<constructor-arg name="previousEventConfigFileName"	value="config/SPARQL/finding_previousEvent_Scope1.txt" />
		<property name="ksAdapter" ref="ksAdapter" />
		<property name="nThreads" value="1"/>
	</bean>

	<bean id="finder2"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.finding.EventFinder">
		<constructor-arg name="userQueryConfigFileName"	value="config/SPARQL/finding_userQuery_Scope1.txt" />
		<constructor-arg name="userInterestConfigFileName" value="config/SPARQL/finding_userInterest_Scope1.txt" />
		<constructor-arg name="previousEventConfigFileName"	value="config/SPARQL/finding_previousEvent_Scope1.txt" />
		<property name="ksAdapter" ref="ksAdapter" />
		<property name="nThreads" value="0"/>
	</bean>

	<bean id="filter0" class="edu.kit.anthropomatik.isl.newsTeller.retrieval.filtering.DummyEventFilter">
	</bean>

	<bean id="filter2" class="edu.kit.anthropomatik.isl.newsTeller.retrieval.filtering.BayesEventFilter">
		<property name="bayes" ref="bayesFusion" />
		<property name="threshold" value="0.5" />
	</bean>

	<bean id="relevanceScorer0"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.scoring.RelevanceScorer">
		<property name="eventHeuristics">
			<list></list>
		</property>
		<property name="queryHeuristics">
			<list></list>
		</property>
		<property name="interestHeuristics">
			<list></list>
		</property>
		<property name="historyHeuristics">
			<list></list>
		</property>
	</bean>

	<bean id="relevanceScorer2"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.scoring.RelevanceScorer">
		<property name="eventHeuristics">
			<list>
				<!-- TODO: eventHeuristics beans go here! (Scope 2) -->
			</list>
		</property>
		<property name="queryHeuristics">
			<list></list>
		</property>
		<property name="interestHeuristics">
			<list></list>
		</property>
		<property name="historyHeuristics">
			<list></list>
		</property>
	</bean>

	<bean id="relevanceAggregator"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.aggregating.SimpleAverageAggregator">
	</bean>

	<bean id="ranker0" class="edu.kit.anthropomatik.isl.newsTeller.retrieval.ranking.EventRanker">
		<property name="scoreAggregator" ref="relevanceAggregator" />
	</bean>

	<bean id="selector0"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.selecting.EventSelector">
	</bean>

	<bean id="retriever0"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.EventRetriever">
		<property name="eventFinder" ref="finder0" />
		<property name="eventFilter" ref="filter0" />
		<property name="relevanceScorer" ref="relevanceScorer0"/>
		<property name="eventRanker" ref="ranker0" />
		<property name="eventSelector" ref="selector0" />
	</bean>

	<bean id="retriever1"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.EventRetriever">
		<property name="eventFinder" ref="finder1" />
		<property name="eventFilter" ref="filter0" />
		<property name="relevanceScorer" ref="relevanceScorer0"/>
		<property name="eventRanker" ref="ranker0" />
		<property name="eventSelector" ref="selector0" />
	</bean>

	<bean id="retriever2"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.EventRetriever">
		<property name="eventFinder" ref="finder1" />
		<property name="eventFilter" ref="filter0" />
		<property name="relevanceScorer" ref="relevanceScorer2"/>
		<property name="eventRanker" ref="ranker0" />
		<property name="eventSelector" ref="selector0" />
	</bean>

	<bean id="generator0"
		class="edu.kit.anthropomatik.isl.newsTeller.generation.DummySummaryCreator">
		<property name="ksAdapter" ref="ksAdapter" />
	</bean>

	<bean id="generator1"
		class="edu.kit.anthropomatik.isl.newsTeller.generation.SentencePicker">
		<property name="ksAdapter" ref="ksAdapter" />
	</bean>

	<bean id="userModel0"
		class="edu.kit.anthropomatik.isl.newsTeller.userModel.DummyUserModel">
	</bean>

	<bean id="newsTeller0"
		class="edu.kit.anthropomatik.isl.newsTeller.newsTeller.NewsTeller">
		<constructor-arg value="./config/logging-test.properties" />
		<property name="userModel" ref="userModel0" />
		<property name="retriever" ref="retriever0" />
		<property name="generator" ref="generator0" />
	</bean>
	
	<bean id="newsTeller1"
		class="edu.kit.anthropomatik.isl.newsTeller.newsTeller.NewsTeller">
		<constructor-arg value="./config/logging-test.properties" />
		<property name="userModel" ref="userModel0" />
		<property name="retriever" ref="retriever1" />
		<property name="generator" ref="generator1" />
	</bean>

	<bean id="newsTeller2"
		class="edu.kit.anthropomatik.isl.newsTeller.newsTeller.NewsTeller">
		<constructor-arg value="./config/logging-test.properties" />
		<property name="userModel" ref="userModel0" />
		<property name="retriever" ref="retriever2" />
		<property name="generator" ref="generator1" />
	</bean>

	<bean id="bayesFusionTest" class="edu.kit.anthropomatik.isl.newsTeller.retrieval.filtering.NaiveBayesFusion">
		<constructor-arg name="fileName" value="resources/test/priors.csv"/>
		<property name="features">
			<set>
				<ref bean="A0FeatureTest"/>
			</set>
		</property>
	</bean>

	<bean id="bayesFusion" class="edu.kit.anthropomatik.isl.newsTeller.retrieval.filtering.NaiveBayesFusion">
		<constructor-arg name="fileName" value="resources/usabilityProbabilities/priors.csv"/>
		<property name="features">
			<set>
				<ref bean="A0Feature"/>
				<ref bean="A1Feature"/>
				<ref bean="wordNetFeature"/>
				<ref bean="eventLabelFeature"/>
				<ref bean="hasActorFeature"/>
				<ref bean="hasPlaceFeature"/>
				<ref bean="hasTimeFeature"/>
				<ref bean="isSpeechCognitiveFeature"/>
				<ref bean="isStatementFeature"/>
				<ref bean="numberOfMentionsFeature"/>
				<!-- 
				
				 -->
			</set>
		</property>
	</bean>
	
	<bean id="filteringBenchmark" class="edu.kit.anthropomatik.isl.newsTeller.retrieval.filtering.FilteringBenchmark">
		<constructor-arg value="resources/benchmark/Scope 0.csv"/>
		<property name="ksAdapter" ref="ksAdapter" />
		<property name="bayesFusion" ref="bayesFusion" />
		
		<property name="doFeatureAnalysis" value="false" />
		<property name="doCreateFeatureMap" value="false" />
		<property name="doResubstitutionTest" value="true" />
		<property name="doIndividualResubstitutionTests" value="true" />
		
		<property name="useLogarithmicProbabilities" value="true" />
		<property name="outputOnlyFalsePositives" value="false" />
		
		<property name="features">
			<list>
				<ref bean="A0Feature"/>
				<ref bean="A2Feature" />
				<ref bean="numberOfFramesFeature" />
				<ref bean="numberOfLinksFeature" />
				<ref bean="areActorsAgentsFeature"/>
				<ref bean="arePlacesPlacesFeature"/>
				<ref bean="numberOfEntityLabelsDBPediaFeature" />
				<ref bean="appearLabelsInTextFeature" />
				
				<ref bean="A1Feature"/>
				<ref bean="eventLabelFeature"/> 
				<ref bean="hasActorFeature"/>
				<ref bean="hasPlaceFeature"/>
				<ref bean="hasTimeFeature"/>
				<ref bean="isSpeechCognitiveFeature"/>
				<ref bean="isStatementFeature"/>
				<ref bean="numberOfMentionsFeature"/>
				<ref bean="wordNetFeature"/>
				<!-- 
				
				
				<ref bean="hasKeywordAsLabelFeature"/>
				
				
				 -->
			</list>
		</property>
	</bean>

	<bean id="runtimeTester" class="edu.kit.anthropomatik.isl.newsTeller.RuntimeTester">
		<constructor-arg name="configFileName" value="resources/benchmark/Scope 0.csv"/>
		<property name="ksAdapter" ref="ksAdapter"/>
		<property name="stemmedKeywords">
			<set>
				<value>album</value>
				<value>artifici intellig</value>
				<value>Berlin</value>
				<value>champion leagu</value>
				<value>chancellor</value>
				<value>charit(i|y)</value>
				<value>Chernobyl</value>
				<value>cinema</value>
				<value>climat</value>
				<value>comed(i|y)</value>
				<value>concert</value>
				<value>contradict</value>
				<value>danc</value>
				<value>earthquak</value>
				<value>Edinburgh</value>
				<value>Edmund Hillar(i|y)</value>
				<value>erupt</value>
				<value>European Space Agenc</value>
				<value>Facebook</value>
				<value>Fukushima</value>
				<value>Hawk</value>
				<value>Himalaya</value>
				<value>hurrican Katrina</value>
				<value>IBM</value>
				<value>Iceland</value>
				<value>kiss</value>
				<value>Lehman Brother</value>
				<value>malipul</value>
				<value>marathon</value>
				<value>Medvedev</value>
				<value>Merkel</value>
				<value>Michael Jackson</value>
				<value>Mount Everest</value>
				<value>museum</value>
				<value>power station</value>
				<value>Real Madrid</value>
				<value>Rhine</value>
				<value>riot</value>
				<value>Rome</value>
				<value>Sahara</value>
				<value>Star War</value>
				<value>Tom Cruis</value>
				<value>upload</value>
				<value>volcano</value>
				<value>Watson</value>
			</set>
		</property>
		
		<property name="sparqlFindingQueries">
			<set>
				<value>resources/SPARQL/finding/findByActor.qry</value>
				<value>resources/SPARQL/finding/findByPlace.qry</value>
				<value>resources/SPARQL/finding/findByLabel.qry</value>
			</set>
		</property>
		
		<property name="sparqlFeatureQueries">
			<set>
				<value>resources/SPARQL/usability/A0.qry</value>
				<value>resources/SPARQL/usability/A1.qry</value>
				<value>resources/SPARQL/usability/A2.qry</value>
				<value>resources/SPARQL/usability/areActorsAgents.qry</value>
				<value>resources/SPARQL/usability/arePlacesPlaces.qry</value>
				<value>resources/SPARQL/usability/eventLabel.qry</value>
				<value>resources/SPARQL/usability/hasActor.qry</value>
				<value>resources/SPARQL/usability/hasPlace.qry</value>
				<value>resources/SPARQL/usability/hasTime.qry</value>
				<value>resources/SPARQL/usability/isSpeechCognitive.qry</value>
				<value>resources/SPARQL/usability/isStatement.qry</value>
				<value>resources/SPARQL/usability/numberOfEntityLabelsDBPedia.qry</value>
				<value>resources/SPARQL/usability/numberOfFrames.qry</value>
				<value>resources/SPARQL/usability/numberOfLinks.qry</value>
				<value>resources/SPARQL/usability/numberOfMentions.qry</value>
			</set>
		</property>
		
		<property name="sequentialFinder" ref="finder1"/>
		<property name="parallelFinder" ref="finder2"/>
		
		<property name="doKSAccessTests" value="false"/>
		<property name="doSparqlFindingTests" value="false"/>
		<property name="doSparqlFeatureTests" value="false"/>
		<property name="doSequentialFinderTest" value="false"/>
		<property name="doParallelFinderTest" value="true"/>
		
		<property name="numberOfRepetitions" value="5"/>
		
	</bean>

</beans>