<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

	<import resource="usabilityFeatures.xml" />

	<bean id="ksAdapter"
		class="edu.kit.anthropomatik.isl.newsTeller.knowledgeStore.KnowledgeStoreAdapter">
		<constructor-arg name="getMentionFromEventFileName"
			value="resources/SPARQL/general/getMentionFromEvent.qry" />
		<constructor-arg name="getEventFromMentionFileName"
			value="resources/SPARQL/general/getEventFromMention.qry" />
		<property name="serverURL" value="https://knowledgestore2.fbk.eu/nwr/wikinews" />
		<property name="timeoutMsec" value="10000" />
		<property name="maxNumberOfConnections" value="100"/>
	</bean>

	<bean id="searcher"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.search.EventSearcher">
		<constructor-arg name="userQueryConfigFileName"	value="config/SPARQL/search_userQuery_Scope1.txt" />
		<constructor-arg name="userInterestConfigFileName" value="config/SPARQL/search_userInterest_Scope1.txt" />
		<constructor-arg name="previousEventConfigFileName" value="config/SPARQL/search_previousEvent_Scope1.txt" />
		<property name="ksAdapter" ref="ksAdapter" />
		<property name="nThreads" value="3"/>
	</bean>

	<bean id="filter" class="edu.kit.anthropomatik.isl.newsTeller.retrieval.filtering.ParallelEventFilter">
		<constructor-arg name="classifierFileName" value="resources/filtering.model" />
		<property name="features" ref="activeFeatureList" />
		<property name="ksAdapter" ref="ksAdapter" />
		<property name="numThreads" value="1000" />
	</bean>

	<bean id="relevanceScorer"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.scoring.RelevanceScorer">
		<property name="eventHeuristics">
			<list>
				<!-- TODO: eventHeuristics beans go here! (Scope 2) -->
			</list>
		</property>
		<property name="queryHeuristics">
			<list>
				<!-- TODO: queryHeuristics beans go here! (Scope 3) -->
			</list>
		</property>
		<property name="interestHeuristics">
			<list>
				<!-- TODO: interestHeuristics beans go here! (Scope 4) -->
			</list>
		</property>
		<property name="historyHeuristics">
			<list>
				<!-- TODO: historyHeuristics beans go here! (Scope 6/7) -->
			</list>
		</property>
	</bean>

	<bean id="relevanceAggregator"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.aggregating.SimpleAverageAggregator">
	</bean>

	<bean id="ranker" class="edu.kit.anthropomatik.isl.newsTeller.retrieval.ranking.EventRanker">
		<property name="scoreAggregator" ref="relevanceAggregator" />
	</bean>

	<bean id="selector"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.selecting.EventSelector">
	</bean>

	<bean id="retriever"
		class="edu.kit.anthropomatik.isl.newsTeller.retrieval.EventRetriever">
		<property name="eventSearcher" ref="searcher" />
		<property name="eventFilter" ref="filter" />
		<property name="relevanceScorer" ref="relevanceScorer"/>
		<property name="eventRanker" ref="ranker" />
		<property name="eventSelector" ref="selector" />
	</bean>

	<bean id="generator"
		class="edu.kit.anthropomatik.isl.newsTeller.generation.SentencePicker">
		<property name="ksAdapter" ref="ksAdapter" />
	</bean>

	<bean id="userModel"
		class="edu.kit.anthropomatik.isl.newsTeller.userModel.DummyUserModel">
	</bean>

	<bean id="newsTeller"
		class="edu.kit.anthropomatik.isl.newsTeller.newsTeller.NewsTeller">
		<constructor-arg value="./config/logging.properties" />
		<property name="userModel" ref="userModel" />
		<property name="retriever" ref="retriever" />
		<property name="generator" ref="generator" />
		<property name="ksAdapter" ref="ksAdapter" />
	</bean>

	<bean id="main" class="edu.kit.anthropomatik.isl.newsTeller.main.Main">
		<property name="newsTeller" ref="newsTeller" />
	</bean>

	<bean id="featureExtractor" class="edu.kit.anthropomatik.isl.newsTeller.tools.FeatureExtractor">
		<constructor-arg value="resources/benchmark/Scope 0.csv"/>
		<property name="ksAdapter" ref="ksAdapter"/>
		<property name="inputFileName" value="resources/benchmark/dataSet_FINAL.xrff" />
		<property name="outputFileName" value="resources/benchmark/dataSet.xrff"/>
		<property name="features" ref="activeFeatureList"/>
		<property name="doAddEventInformation" value="false"/>
		<property name="doAddReasonInformation" value="false"/>
		<property name="doKeepOnlyListedReasons" value="false"/>
		<property name="doFiltering" value="true" />
		<property name="reasonsToKeep">
			<set>
				<value>1</value>
				<value>2</value>
				<value>3</value>
				<value>13</value>
			</set>
		</property>
	</bean>

	<bean id="classifierTrainer" class="edu.kit.anthropomatik.isl.newsTeller.tools.ClassifierTrainer">
		<constructor-arg value="resources/benchmark/dataSet.xrff"/>
		<property name="classifiers">
			<list>
				<bean class="weka.classifiers.meta.MetaCost">
					<property name="options">
						<array>
							<value>-cost-matrix</value>
							<value>"[0.0 3.0; 1.0 0.0]"</value>	<!-- the cost matrix (row-wise): [TP FN; FP TN] -->
						</array>
					</property>
					<property name="classifier">
						<bean class="weka.classifiers.trees.RandomForest">
							<property name="numExecutionSlots" value="10" />
							<property name="maxDepth" value="20" />
							<property name="numFeatures" value="15" />
							<property name="numTrees" value="50" />
							<property name="breakTiesRandomly" value="false" />
						</bean>
					</property>
				</bean>
			</list>
		</property>
		<property name="fileNames">
			<list>
				<value>resources/filtering.model</value>
			</list>
		</property>
	</bean>

</beans>